async function uploadFile() {
  const user = gapi.auth2.getAuthInstance().currentUser.get();
  const isAuthorized = user.hasGrantedScopes(SCOPES);
  if (!isAuthorized) {
    document.getElementById("status").innerText = "Anda belum login atau belum memberikan izin.";
    return;
  }

  const accessToken = gapi.auth.getToken().access_token;
  const file = document.getElementById('fileInput').files[0];
  if (!file) {
    document.getElementById("status").innerText = "Pilih file terlebih dahulu.";
    return;
  }

  const metadata = {
    name: file.name,
    mimeType: file.type
  };

  const form = new FormData();
  form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
  form.append('file', file);

  const res = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id', {
    method: 'POST',
    headers: new Headers({ 'Authorization': 'Bearer ' + accessToken }),
    body: form,
  });

  const result = await res.json();
  if (result.id) {
    document.getElementById("status").innerText = "Upload berhasil! ID File: " + result.id;
  } else {
    document.getElementById("status").innerText = "Upload gagal. Cek konsol.";
    console.error(result);
  }
}
